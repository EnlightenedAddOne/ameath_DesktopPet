# 新功能使用说明

## 🎉 新增功能概览

### 1. 点击互动反馈 💬

**功能描述：**
单击宠物时，宠物会显示对话气泡，根据时间显示不同的问候语或互动台词。

**使用方法：**
- 单击宠物（非拖动）
- 宠物会显示随机的互动对话
- 对话气泡 2-4 秒后自动消失

**对话类型：**
- **时间段问候**：根据当前时间显示（早上好/中午好/晚上好等）
- **随机互动**："我在这里陪着你哦~"、"记得多喝水！"等
- **点击反应**："哎呀，被发现了！"、"哈哈，好痒！"等

---

### 2. 智能作息系统 🌙

**功能描述：**
根据系统时间自动调整宠物的行为模式，包括睡眠状态、提醒功能等。

**时间段划分：**
- **凌晨 (0:00-6:00)**：睡眠模式 - 移动缓慢，显示"困了"提示
- **早上 (6:00-11:00)**：早晨模式 - 元气满满
- **中午 (11:00-14:00)**：午休模式 - 活跃但会提醒休息
- **下午 (14:00-18:00)**：下午模式 - 正常工作
- **晚上 (18:00-22:00)**：晚间模式 - 轻松状态
- **深夜 (22:00-24:00)**：准备睡眠 - 移动减慢

**智能提醒功能（每30-60分钟）：**
- 💧 **喝水提醒**："记得喝水哦~"
- 😴 **休息提醒**："休息一下吧~"
- 🪑 **坐姿提醒**："注意坐姿哦~"

---

### 3. 双击快捷菜单 ⚡

**功能描述：**
双击宠物弹出快捷操作菜单，无需右键托盘图标即可快速操作。

**使用方法：**
- 快速双击宠物（300ms内两次点击）
- 弹出快捷菜单
- 菜单会自动关闭（点击外部或选择功能后）

**菜单功能：**
- ⏸️ 暂停/继续
- 👻 鼠标穿透
- 🐭 跟随鼠标
- 🔍 放大
- 🔎 缩小
- 👁️ 隐藏宠物
- ❌ 关闭菜单

---

### 4. 全局快捷键 ⌨️

**功能描述：**
使用键盘快捷键在任何地方控制宠物，即使宠物被其他窗口遮挡。

**快捷键列表：**

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+Shift+H` | 显示/隐藏宠物 |
| `Ctrl+Shift+P` | 暂停/继续活动 |
| `Ctrl+Shift+S` | 显示快捷菜单 |
| `Ctrl+Shift+Q` | 退出程序 |

**使用场景：**
- 在全屏工作时快速隐藏宠物
- 不需要鼠标操作托盘图标
- 快捷控制，提高效率

---

## 📝 文件变更

### 新增文件
- `speech_bubble.py` - 对话气泡模块
- `quick_menu.py` - 快捷菜单模块
- `hotkey.py` - 全局快捷键模块

### 修改文件
- `pet.py` - 添加互动系统、作息系统、双击菜单集成
- `main.py` - 注册全局快捷键
- `constants.py` - 添加作息配置参数

---

## 🔧 技术实现

### 点击互动检测
- 使用 300ms 时间窗口区分单击和双击
- 如果移动距离超过 5 像素，则判定为拖动而非点击
- 单击显示互动对话，双击显示快捷菜单

### 智能作息
- 每分钟检查一次当前时间段
- 根据时间段调整移动速度和待机概率
- 定时发送健康提醒（喝水、休息、坐姿）

### 全局快捷键
- 使用 Windows API `RegisterHotKey` 注册全局热键
- 拦截窗口消息处理快捷键事件
- 程序退出时自动注销热键

---

## 💡 使用建议

1. **首次使用**：单击宠物几次看看它会说什么！
2. **深夜工作**：观察宠物进入睡眠模式后的缓慢移动
3. **效率操作**：记住 `Ctrl+Shift+H` 快速隐藏/显示
4. **双击菜单**：关闭鼠标穿透后，双击宠物快速操作

---

## 🐛 注意事项

1. 全局快捷键需要程序有窗口句柄，启动后约 100ms 才能注册成功
2. 如果在睡眠时段（0:00-6:00）启动，宠物会立即进入睡眠模式
3. 双击菜单在宠物被其他窗口遮挡时可能显示在错误位置
4. 全局快捷键可能与某些应用程序的快捷键冲突

---

## 🎨 自定义建议

### 修改对话内容
编辑 `speech_bubble.py` 中的以下变量：
- `GREETINGS` - 时间段问候语
- `RANDOM_LINES` - 随机互动台词
- `CLICK_REACTIONS` - 点击反应台词

### 调整作息参数
编辑 `constants.py` 中的：
- `TIME_*_START` - 时间段划分
- `REMINDERS` - 提醒间隔和消息
- `SLEEP_SPEED_MULTIPLIER` - 睡眠时速度

### 修改快捷键
编辑 `hotkey.py` 中的 `_register_default_hotkeys` 方法，
可以更改快捷键组合或添加新的快捷键。

---

*祝你使用愉快！有任何问题欢迎反馈~*
